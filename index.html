<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Booking Slots</title>
    <style>
        body {
            background: linear-gradient(135deg, #74ebd5, #9face6);
            font-family: Arial, sans-serif;
            text-align: center;
            color: white;
        }
        .auth-buttons {
            margin-top: 20px;
        }
        button {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            transition: background 0.3s;
        }
        button:hover {
            opacity: 0.9;
        }
        .sign-in {
            background-color: #4285F4;
            color: white;
        }
        .sign-out {
            background-color: #DB4437;
            color: white;
        }
        .slot-grid {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            gap: 10px;
            margin: 20px auto;
            width: 80%;
        }
        .slot {
            background-color: white;
            color: black;
            border: 2px solid #74ebd5;
            border-radius: 5px;
            padding: 10px;
            cursor: pointer;
            transition: background 0.3s;
        }
        .slot.selected {
            background-color: #4CAF50;
            color: white;
        }
        .slot.booked {
            background-color: #FF5722;
            color: white;
            cursor: not-allowed;
        }
        .confirmation-tab {
            display: none;
            background: white;
            color: black;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            width: 50%;
            margin: 20px auto;
        }
        .search-bar {
            margin: 20px auto;
            width: 50%;
        }
    </style>
</head>
<body>
    <h1>Booking Slots</h1>
    <div class="auth-buttons">
        <button class="sign-in" onclick="signIn()">Sign In with Google</button>
        <button class="sign-out" onclick="signOut()">Sign Out</button>
    </div>

    <h3>Total Slots Booked: <span id="total-slots">0</span></h3>
    <h3>Total Amount: â‚¹<span id="total-amount">0</span></h3>

    <input type="text" class="search-bar" id="phone-search" placeholder="Search by Phone Number">

    <div class="slot-grid" id="slot-grid"></div>
    <div class="confirmation-tab" id="confirmation-tab">
        <h2>Confirm Booking</h2>
        <p>Selected Slots: <span id="selected-slots"></span></p>
        <p>Phone Number: <input type="text" id="phone-number" placeholder="Enter Phone Number"></p>
        <button onclick="confirmBooking()">Confirm</button>
    </div>
<script>
    // Firebase configuration
    const firebaseConfig = {
        apiKey: "AIzaSyBD77vl_0K-xbV4f3LNHK3yFKi51V_C_zE",
        authDomain: "booking-slot-a1edb.firebaseapp.com",
        databaseURL: "https://booking-slot-a1edb-default-rtdb.firebaseio.com",
        projectId: "booking-slot-a1edb",
        storageBucket: "booking-slot-a1edb.firebasestorage.app",
        messagingSenderId: "31706590505",
        appId: "1:31706590505:web:43b931de69cf9e9e8ddb38",
        measurementId: "G-B91QJCE3VT"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const provider = new firebase.auth.GoogleAuthProvider();
    const database = firebase.database();
    let currentUser = null;

    auth.onAuthStateChanged(user => {
        if (user) {
            document.querySelector(".sign-in").style.display = "none";
            document.querySelector(".sign-out").style.display = "inline-block";
            currentUser = user;
            loadSlots();
        } else {
            document.querySelector(".sign-in").style.display = "inline-block";
            document.querySelector(".sign-out").style.display = "none";
            currentUser = null;
        }
    });

    function loadSlots() {
        const slotGrid = document.getElementById("slot-grid");
        slotGrid.innerHTML = '';
        for (let i = 1; i <= 500; i++) {
            const slot = document.createElement("div");
            slot.classList.add("slot");
            slot.textContent = "Slot " + i;
            slot.onclick = () => selectSlot(i);
            slotGrid.appendChild(slot);
        }
    }

    function selectSlot(slotNumber) {
        const confirmationTab = document.getElementById("confirmation-tab");
        const selectedSlots = document.getElementById("selected-slots");
        selectedSlots.textContent = slotNumber;
        confirmationTab.style.display = "block";
    }

    function confirmBooking() {
        const phoneNumber = document.getElementById("phone-number").value;
        if (currentUser && phoneNumber) {
            const selectedSlot = document.getElementById("selected-slots").textContent;
            const bookingRef = database.ref("bookedSlots/" + phoneNumber);
            bookingRef.set([parseInt(selectedSlot)]);
            alert("Booking Confirmed!");
        }
    }

    document.getElementById("phone-search").addEventListener("input", function() {
        const phoneNumber = this.value;
        const slotGrid = document.getElementById("slot-grid");
        slotGrid.innerHTML = '';
        if (phoneNumber) {
            const searchRef = database.ref("bookedSlots/" + phoneNumber);
            searchRef.once("value", snapshot => {
                const bookedSlots = snapshot.val() || [];
                bookedSlots.forEach(slotNumber => {
                    const slot = document.createElement("div");
                    slot.classList.add("slot", "booked");
                    slot.textContent = "Slot " + slotNumber;
                    slotGrid.appendChild(slot);
                });
            });
        } else {
            loadSlots();
        }
    });
</script>
</body>
</html>
